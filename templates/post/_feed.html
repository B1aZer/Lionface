{% load media comments format_results friends %}
{% load oembed_tags %}

{% for item in items %}
{% if not notification %}
	<hr style="position: relative; left: 50px; background-color: #E7E7E7; layer-background-color: #EEE; border: 1px solid #EEE; border-width: 1px 0 0 0; height: 1;" width="600" align="left" noshade="noshade" />
{% endif %}
<div id="post_{{ item.get_post.id }}" class="result post_{{ item.id }}  {type: '{{item.get_type}}', user: '{{ item.user.id}}', postid: '{{ item.id }}', model: '{{ item.get_type_class }}' }">
<div class="result_post" style="padding: 15px 8px 5px 8px; width: 535px;">
    {% block thumbnail %}
    {% if item.get_type == 'page post' %}
    <a href="{{item.get_page_url}}"><div class="user_thumbnail" style="background-image: url('/{{ item.get_owner.photo }}'); background-size: 50px 50px;"></div></a>
    {% else %}
    <a href="{{item.get_owner.get_absolute_url}}"><div class="user_thumbnail" style="background-image: url('/{{ item.get_owner.photo }}'); background-size: 50px 50px;"></div></a>
    {% endif %}
        
    {% endblock %}
    {{ item.render|smileys|excerpt|linebreaks|color_tags }}
    <div class="subtext">
    {% if item.get_type != 'friend post' %}
        <div>
            <span id="hide_comment_link_{{ item.get_post.id }}" {% if not item.get_comment_settings %} style="display: none;" {% endif %}>
                <a class="toggle_comments" href="">Comment</a>{% ifequal item.get_post|get_comment_counter:request.user 0 %} {% else %} 
					<span style="color: #555; padding: 2px;">{{ item.get_post|get_comment_counter:request.user }}</span> {% endifequal %} <span style="color: transparent;"> - | - </span>
            </span>
            <span id="hide_share_{{ item.get_post.id }}" {% if not item.get_share_settings %} style="display: none;" {% endif %}>
                <a href="javascript:LionFace.Site.share_post({{ item.id }});">Share</a> {% ifequal item.shared 0 %} {% else %} 
					<span style="color: #555; padding: 2px;">{{ item.shared }}</span> {% endifequal %} <span style="color: transparent;"> - | - </span>
            </span>
            {% if news_feed and item.user|has_friend:request.user and not request.user|in_hidden:item.user %}
            <a href="#" class="hide_feed">Hide Feed</a>
            {% endif %}
            {% if news_feed and item.user|in_followers:request.user and not item.user|has_friend:request.user %}
            <a href="#" class="unfollow_feed link-unfollow { user: '{{ item.user.id }}' }">- Unfollow</a>
            {% endif %}
        </div>
        <div class="share_text" style="display: none;">
        </div>
        {% if item.get_owner == request.user %}
        <div class="post_settings" style="display:none">
            {% block post_settings %}
            <form>
                <input type="checkbox" name="comment_settings" value="on" 
                    {% if item.get_owner != item.get_wall_user %}
                        checked="checked" disabled="disabled"
                    {% else %}
                        {% if item.get_comment_settings %}
                            checked="checked" 
                        {% endif %} 
                    {% endif %} >
                    Comments
                <span style="color: transparent;"> -- -- -- </span>
                <input type="checkbox" name="sharing_settings" value="on" {% if item.get_share_settings %}checked="checked"{% endif %}> Share<span style="color: transparent;"> -- </span>
                <span style="color: transparent;"> -- -- -- - </span>
                {% if item.get_type == 'content post' %}
                <select name="privacy_settings">
                    {% if item.get_owner == item.get_wall_user %}
                        <option value="Public" {% if item.get_privacy == "P" %} selected="selected" {% endif %}>Public</option>
                    {% endif %}
                    <option value="Friends" {% if item.get_privacy == "F" %} selected="selected" {% endif %}>Friends</option>
                </select>
                {% endif %}
                {% if request.user.get_albums %}
                <span style="color: transparent;"> -- -- -- - </span>Album: <select name="attach_to_album">
                    <option value=""{% if not item.get_album %}selected="selected"{% endif %}></option>
                    {% for album in request.user.get_albums %}
                    <option value="{{ album.id }}" {% if album == item.get_album %} selected="selected" {% endif %}>{{ album.name }}</option>
                    {% endfor %}
                </select>
                {% endif %}
            </form>
            {% endblock %}
        </div>
        {% endif %}
        <br />
        <div id="hide_comment_{{ item.get_post.id }}" {% if not item.get_comment_settings %}  style="display:none" {% endif %} >
            <div class="comments comment_{{ item.id }}" style="display: none;">
                <div class="comment_container">
                {% render_comment_list for item.get_post %}
                {% render_comment_form for item.get_post %}
                </div>
            </div>
        </div>
    {% endif %}

    <div id="{{item.id}}" {% if item.get_type != 'friend post' %} style="display: none;" {% endif %}>

        <div class="post_timestamp">
            {% if item.get_type != 'friend post' %}
                <span id="hide_follow_link_{{ item.get_post.id }}" {% if not item.get_comment_settings %} style="display: none;" {% endif %}>
                    {% if item|follows:request.user %}
                    <a href="#" class="follow_post">Unfollow</a> {% ifequal item|following 0 %} {% else %} 
						<span style="color: #555; padding: 2px;">{{ item|following }}</span> {% endifequal %} <span style="color: transparent;"> - | - </span> 
                    {% else %}
                    <a href="#" class="follow_post">Follow</a> {% ifequal item|following 0 %} {% else %} 
						<span style="color: #555; padding: 2px;">{{ item|following }}</span> {% endifequal %} <span style="color: transparent;"> - | - </span> 
                    {% endif %}
                </span>
            {% endif %}
            <span class="timestamp" title="{% widthratio item.timestamp|date:"Z" 3600 1 %}:00" >{{ item.timestamp }}</span>
        </div>
        <div class="post_bottom">
            {% if not del_false %}
            <!--This will fire on news feed-->
                {% if item.get_owner.id == request.user.id  or item.get_post.user_to.id == request.user.id %}
                    {% if item.get_type != 'friend post' and item.get_owner == request.user %}
                    <a href="#" class="toggle_settings" >Settings</a> 
                    {% endif %}
                    {% if item.get_type == 'friend post' and item.user != request.user %}
                    {% else %}
				<a href="javascript:LionFace.Site.del_post({{item.id}});">Delete</a> 
                    {% endif %}
                {% endif %}
                {% if item.get_privacy == "P" %}
                <a style="cursor:pointer;"><span class="toggle_privacy" title="Privacy Settings: Public">Public</span></a>
                {% elif item.get_privacy == "F" %}
                <a style="cursor:pointer;"><span class="toggle_privacy" title="Privacy Settings: Friends Only">Friends</span></a>
                {% else %}
                {% endif %}
            {% else %}
            <!--This will fire on ajax posting-->
                {% if item.user.id == request.user.id  or item.user_to.id == request.user.id %}
                    {% if item.get_type != 'friend post' and item.get_owner == request.user %}
                    <a href="#" class="toggle_settings" >Settings</a> 
                    {% endif %}
                <a href="javascript:LionFace.Site.del_post_single({{item.id}});">Delete</a>
                {% endif %}
                {% if item.type == "P" %}
                <a style="cursor:pointer;"><span class="toggle_privacy" title="Privacy Settings: Public">Public</span></a>
                {% elif item.type == "F" %}
                <a style="cursor:pointer;"><span class="toggle_privacy" title="Privacy Settings: Friends Only">Friends</span></a>
                {% else %}
                {% endif %}
            {% endif %}
            {% url users-albums-posts username=item.get_owner.username album_id=item.get_album.id as the_url %}
            <a href="{{ the_url }}" class="album_name" style="color: #C92;{% if not the_url %} display:none;{% endif %}">{{ item.get_album.name }}</a>
        </div>
		</div>
    </div>
</div>
</div>
{% empty %}
{% if request.user.get_filters or request.user.get_active_tags %}
<p class="no_posts">There is nothing to share.</p>
{% else %}
<p class="no_posts">No filters have been selected.</p>
{% endif %}
{% endfor %}

{% if items.has_next %}
{% block see_more %}

<a id="see_more_feed" href="?page={{ items.next_page_number }}"> See More </a>

{% endblock %}
{% endif %}
