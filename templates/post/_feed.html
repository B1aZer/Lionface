{% load media comments format_results friends %}

{% for item in items %}
{% get_comment_count for item as comment_count %}
{% if not notification %}
	<hr style="position: relative; left: 50px; background-color: #E7E7E7; layer-background-color: #EEE; border: 1px solid #EEE; border-width: 1px 0 0 0; height: 1;" width="600" align="left" noshade="noshade" />
{% endif %}
<div id="post_{{ item.get_id }}" class="result post_{{ item.id }} {type: '{{item.get_type}}', user: '{{ item.user.id }}', postid: '{{ item.id }}' }" onMouseOver="ShowContent('{{item.id}}'); return false;" onMouseOut="HideContent('{{item.id}}'); return false;" style="padding: 15px 8px 5px 8px; width: 535px;">
    <a href="{{item.get_owner.get_absolute_url}}"><div class="user_thumbnail" style="background-image: url('/{{ item.get_owner.photo|format_image:request.get_full_path }}'); background-size: 50px 50px;"></div></a>
    {{ item.render|smileys|excerpt|linebreaks|color_tags }}
    <div class="subtext">
    {% if item.get_type != 'friend post' %}
        <div>
            <span id="hide_comment_link_{{ item.get_id }}" {% if not item.get_comment_settings %} style="display: none;" {% endif %}>
                <a class="toggle_comments" href="">Comment</a>{% ifequal comment_count 0 %} {% else %} 
					<span style="color: transparent;">-</span> <span style="color: #555;">{{ comment_count }}</span> {% endifequal %} <span style="color: transparent;"> - | - </span>
            </span>
            <span id="hide_share_{{ item.get_id }}" {% if not item.get_share_settings %} style="display: none;" {% endif %}>
                <a href="javascript:share_post({{ item.id }});">Share</a> {% ifequal item.shared 0 %} {% else %} 
					<span style="color: transparent;">-</span> <span style="color: #555;">{{ item.shared }}</span> {% endifequal %} <span style="color: transparent;"> - | - </span>
            </span>
            {% if news_feed and item.user|has_friend:request.user and not request.user|in_hidden:item.user %}
            <a href="#" class="hide_feed" style="color: #AAA;">Hide Feed</a>
            {% endif %}
            {% if news_feed and item.user|in_followers:request.user and not item.user|has_friend:request.user %}
            <a href="#" class="unfollow_feed link-unfollow { user: '{{ item.user.id }}' }" style="color: #AAA;">Unfollow</a>
            {% endif %}
        </div>
        <div class="share_text" style="display: none;">
        </div>
        <div class="post_settings" style="display:none">
            <form>
                <input type="checkbox" name="comment_settings" value="on" {% if item.get_comment_settings %}checked="checked"{% endif %}> Comments<span style="color: transparent;"> -- -- -- </span>
                <input type="checkbox" name="sharing_settings" value="on" {% if item.get_share_settings %}checked="checked"{% endif %}> Share<span style="color: transparent;"> -- </span>
                <span style="color: transparent;"> -- -- -- - </span>
                {% if item.get_type == 'content post' %}
                <select name="privacy_settings">
                  <option value="Public" {% if item.get_privacy == "P" %} selected="selected" {% endif %}>Public</option>
                  <option value="Friends" {% if item.get_privacy == "F" %} selected="selected" {% endif %}>Friends</option>
                </select>
                {% endif %}
                {% if request.user.get_albums %}
                <span style="color: transparent;"> -- -- -- - </span>Album: <select name="attach_to_album">
                    <option value=""{% if not item.get_album %}selected="selected"{% endif %}></option>
                    {% for album in request.user.get_albums %}
                    <option value="{{ album.id }}" {% if album == item.get_album %} selected="selected" {% endif %}>{{ album.name }}</option>
                    {% endfor %}
                </select>
                {% endif %}
            </form>
        </div><br />
        <div id="hide_comment_{{ item.get_id }}" {% if not item.get_comment_settings %}  style="display:none" {% endif %} >
            <div class="comments comment_{{ item.id }}" style="display: none;">
                <div class="comment_container">
                {% render_comment_list for item %}
                {% render_comment_form for item %}
                </div>
            </div>
        </div>
    {% endif %}

    <div id="{{item.id}}" style="display: none;">

        <div class="post_timestamp">
            {% if item.get_type != 'friend post' %}
                <span id="hide_follow_link_{{ item.get_id }}" {% if not item.get_comment_settings %} style="display: none;" {% endif %}>
                    {% if item|follows:request.user %}
                    <a href="#" class="follow_post">Unfollow</a> {% ifequal item|following 0 %} {% else %} 
						<span style="color: transparent;">-</span> <span style="color: #555;">{{ item|following }}</span> {% endifequal %} <span style="color: transparent;"> - | - </span> 
                    {% else %}
                    <a href="#" class="follow_post">Follow</a> {% ifequal item|following 0 %} {% else %} 
						<span style="color: transparent;">-</span> <span style="color: #555;">{{ item|following }}</span> {% endifequal %} <span style="color: transparent;"> - | - </span> 
                    {% endif %}
                </span>
            {% endif %}
            <span class="timestamp" title="{% widthratio item.timestamp|date:"Z" 3600 1 %}:00" >{{ item.timestamp }}</span>
        </div>


        <div class="post_bottom">
            {% if not del_false %}
            <!--This will fire on news feed-->
                {% if item.get_owner.id == request.user.id  or item.user_to.id == request.user.id or item.user.id == request.user.id %}
                    {% if item.get_type != 'friend post' %}
                    <a href="#" class="toggle_settings" >Settings</a> <span style="color: transparent;"> - | - </span> 
                    {% endif %}
				<a href="javascript:del_post({{item.id}});">Delete</a> <span style="color: transparent;"> - | - </span> 
                {% endif %}
                {% if item.get_privacy == "P" %}
                <a style="cursor:pointer;"><span class="toggle_privacy" title="Privacy Settings: Public">Public</span></a>
                {% elif item.get_privacy == "F" %}
                <a style="cursor:pointer;"><span class="toggle_privacy" title="Privacy Settings: Friends Only">Friends</span></a>
                {% else %}
                {% endif %}
            {% else %}
            <!--This will fire on ajax posting-->
                {% if item.user.id == request.user.id  or item.user_to.id == request.user.id %}
                <a href="javascript:del_post_single({{item.id}});">Delete</a> <span style="color: transparent;"> - | - </span>
                {% endif %}
                {% if item.type == "P" %}
                <a style="cursor:pointer;"><span class="toggle_privacy" title="Privacy Settings: Public">Public</span></a>
                {% elif item.type == "F" %}
                <a style="cursor:pointer;"><span class="toggle_privacy" title="Privacy Settings: Friends Only">Friends</span></a>
                {% else %}
                {% endif %}
            {% endif %}
            {% url profile.views.album_posts album_id=item.get_album.id as the_url %}
            <span style="color: transparent;"> - | - </span> <a href="{{the_url}}" class="album_name" style="color: #C92;">{{ item.get_album.name }}</a>
        </div>
		</div>
    </div>

</div>
{% empty %}
{% if request.user.get_filters or request.user.get_active_tags%}
<p class="no_posts">There is nothing to share.</p>
{% else %}
<p class="no_posts">No filters have been selected.</p>
{% endif %}
{% endfor %}
